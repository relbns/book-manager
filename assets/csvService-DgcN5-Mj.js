import{r as ke,I as xe,h as Se,g as ce}from"./index-CXoMd3eq.js";var Oe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},Pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"};function me(){return me=Object.assign?Object.assign.bind():function(T){for(var B=1;B<arguments.length;B++){var L=arguments[B];for(var h in L)Object.prototype.hasOwnProperty.call(L,h)&&(T[h]=L[h])}return T},me.apply(this,arguments)}const Ce=(T,B)=>ke.createElement(xe,me({},T,{ref:B,icon:Oe})),He=ke.forwardRef(Ce);var de={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/var Ae=de.exports,Ee;function Te(){return Ee||(Ee=1,function(T,B){((L,h)=>{T.exports=h()})(Ae,function L(){var h=typeof self<"u"?self:typeof window<"u"?window:h!==void 0?h:{},U,C=!h.document&&!!h.postMessage,k=h.IS_PAPA_WORKER||!1,Q={},W=0,n={};function c(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var r=ge(t);r.chunkSize=parseInt(r.chunkSize),t.step||t.chunk||(r.chunkSize=null),this._handle=new ue(r),(this._handle.streamer=this)._config=r}).call(this,e),this.parseChunk=function(t,r){var s=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<s){let d=this._config.newline;d||(i=this._config.quoteChar||'"',d=this._handle.guessLineEndings(t,i)),t=[...t.split(d).slice(s)].join(d)}this.isFirstChunk&&E(this._config.beforeFirstChunk)&&(i=this._config.beforeFirstChunk(t))!==void 0&&(t=i),this.isFirstChunk=!1,this._halted=!1;var s=this._partialLine+t,i=(this._partialLine="",this._handle.parse(s,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=i.meta.cursor,s=(this._finished||(this._partialLine=s.substring(t-this._baseIndex),this._baseIndex=t),i&&i.data&&(this._rowCount+=i.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),k)h.postMessage({results:i,workerId:n.WORKER_ID,finished:s});else if(E(this._config.chunk)&&!r){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!s||!E(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),s||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(t){E(this._config.error)?this._config.error(t):k&&this._config.error&&h.postMessage({workerId:n.WORKER_ID,error:t,finished:!1})}}function H(e){var t;(e=e||{}).chunkSize||(e.chunkSize=n.RemoteChunkSize),c.call(this,e),this._nextChunk=C?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(r){this._input=r,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),C||(t.onload=re(this._chunkLoaded,this),t.onerror=re(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!C),this._config.downloadRequestHeaders){var r,s=this._config.downloadRequestHeaders;for(r in s)t.setRequestHeader(r,s[r])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(d){this._chunkError(d.message)}C&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(r=>(r=r.getResponseHeader("Content-Range"))!==null?parseInt(r.substring(r.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(r){r=t.statusText||r,this._sendError(new Error(r))}}function y(e){(e=e||{}).chunkSize||(e.chunkSize=n.LocalChunkSize),c.call(this,e);var t,r,s=typeof FileReader<"u";this.stream=function(i){this._input=i,r=i.slice||i.webkitSlice||i.mozSlice,s?((t=new FileReader).onload=re(this._chunkLoaded,this),t.onerror=re(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var i=this._input,d=(this._config.chunkSize&&(d=Math.min(this._start+this._config.chunkSize,this._input.size),i=r.call(i,this._start,d)),t.readAsText(i,this._config.encoding));s||this._chunkLoaded({target:{result:d}})},this._chunkLoaded=function(i){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(i.target.result)},this._chunkError=function(){this._sendError(t.error)}}function D(e){var t;c.call(this,e=e||{}),this.stream=function(r){return t=r,this._nextChunk()},this._nextChunk=function(){var r,s;if(!this._finished)return r=this._config.chunkSize,t=r?(s=t.substring(0,r),t.substring(r)):(s=t,""),this._finished=!t,this.parseChunk(s)}}function ie(e){c.call(this,e=e||{});var t=[],r=!0,s=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(i){this._input=i,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){s&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=re(function(i){try{t.push(typeof i=="string"?i:i.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(d){this._streamError(d)}},this),this._streamError=re(function(i){this._streamCleanUp(),this._sendError(i)},this),this._streamEnd=re(function(){this._streamCleanUp(),s=!0,this._streamData("")},this),this._streamCleanUp=re(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function ue(e){var t,r,s,i,d=Math.pow(2,53),I=-d,K=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,V=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,p=this,x=0,o=0,q=!1,l=!1,g=[],a={data:[],errors:[],meta:{}};function F(_){return e.skipEmptyLines==="greedy"?_.join("").trim()==="":_.length===1&&_[0].length===0}function A(){if(a&&s&&($("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+n.DefaultDelimiter+"'"),s=!1),e.skipEmptyLines&&(a.data=a.data.filter(function(u){return!F(u)})),z()){let u=function(O,j){E(e.transformHeader)&&(O=e.transformHeader(O,j)),g.push(O)};if(a)if(Array.isArray(a.data[0])){for(var _=0;z()&&_<a.data.length;_++)a.data[_].forEach(u);a.data.splice(0,1)}else a.data.forEach(u)}function v(u,O){for(var j=e.header?{}:[],w=0;w<u.length;w++){var b=w,m=u[w],m=((J,f)=>(R=>(e.dynamicTypingFunction&&e.dynamicTyping[R]===void 0&&(e.dynamicTyping[R]=e.dynamicTypingFunction(R)),(e.dynamicTyping[R]||e.dynamicTyping)===!0))(J)?f==="true"||f==="TRUE"||f!=="false"&&f!=="FALSE"&&((R=>{if(K.test(R)&&(R=parseFloat(R),I<R&&R<d))return 1})(f)?parseFloat(f):V.test(f)?new Date(f):f===""?null:f):f)(b=e.header?w>=g.length?"__parsed_extra":g[w]:b,m=e.transform?e.transform(m,b):m);b==="__parsed_extra"?(j[b]=j[b]||[],j[b].push(m)):j[b]=m}return e.header&&(w>g.length?$("FieldMismatch","TooManyFields","Too many fields: expected "+g.length+" fields but parsed "+w,o+O):w<g.length&&$("FieldMismatch","TooFewFields","Too few fields: expected "+g.length+" fields but parsed "+w,o+O)),j}var S;a&&(e.header||e.dynamicTyping||e.transform)&&(S=1,!a.data.length||Array.isArray(a.data[0])?(a.data=a.data.map(v),S=a.data.length):a.data=v(a.data,0),e.header&&a.meta&&(a.meta.fields=g),o+=S)}function z(){return e.header&&g.length===0}function $(_,v,S,u){_={type:_,code:v,message:S},u!==void 0&&(_.row=u),a.errors.push(_)}E(e.step)&&(i=e.step,e.step=function(_){a=_,z()?A():(A(),a.data.length!==0&&(x+=_.data.length,e.preview&&x>e.preview?r.abort():(a.data=a.data[0],i(a,p))))}),this.parse=function(_,v,S){var u=e.quoteChar||'"',u=(e.newline||(e.newline=this.guessLineEndings(_,u)),s=!1,e.delimiter?E(e.delimiter)&&(e.delimiter=e.delimiter(_),a.meta.delimiter=e.delimiter):((u=((O,j,w,b,m)=>{var J,f,R,ne;m=m||[",","	","|",";",n.RECORD_SEP,n.UNIT_SEP];for(var ae=0;ae<m.length;ae++){for(var G,le=m[ae],P=0,X=0,M=0,N=(R=void 0,new se({comments:b,delimiter:le,newline:j,preview:10}).parse(O)),ee=0;ee<N.data.length;ee++)w&&F(N.data[ee])?M++:(G=N.data[ee].length,X+=G,R===void 0?R=G:0<G&&(P+=Math.abs(G-R),R=G));0<N.data.length&&(X/=N.data.length-M),(f===void 0||P<=f)&&(ne===void 0||ne<X)&&1.99<X&&(f=P,J=le,ne=X)}return{successful:!!(e.delimiter=J),bestDelimiter:J}})(_,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=u.bestDelimiter:(s=!0,e.delimiter=n.DefaultDelimiter),a.meta.delimiter=e.delimiter),ge(e));return e.preview&&e.header&&u.preview++,t=_,r=new se(u),a=r.parse(t,v,S),A(),q?{meta:{paused:!0}}:a||{meta:{paused:!1}}},this.paused=function(){return q},this.pause=function(){q=!0,r.abort(),t=E(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){p.streamer._halted?(q=!1,p.streamer.parseChunk(t,!0)):setTimeout(p.resume,3)},this.aborted=function(){return l},this.abort=function(){l=!0,r.abort(),a.meta.aborted=!0,E(e.complete)&&e.complete(a),t=""},this.guessLineEndings=function(O,u){O=O.substring(0,1048576);var u=new RegExp(Y(u)+"([^]*?)"+Y(u),"gm"),S=(O=O.replace(u,"")).split("\r"),u=O.split(`
`),O=1<u.length&&u[0].length<S[0].length;if(S.length===1||O)return`
`;for(var j=0,w=0;w<S.length;w++)S[w][0]===`
`&&j++;return j>=S.length/2?`\r
`:"\r"}}function Y(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function se(e){var t=(e=e||{}).delimiter,r=e.newline,s=e.comments,i=e.step,d=e.preview,I=e.fastMode,K=null,V=!1,p=e.quoteChar==null?'"':e.quoteChar,x=p;if(e.escapeChar!==void 0&&(x=e.escapeChar),(typeof t!="string"||-1<n.BAD_DELIMITERS.indexOf(t))&&(t=","),s===t)throw new Error("Comment character same as delimiter");s===!0?s="#":(typeof s!="string"||-1<n.BAD_DELIMITERS.indexOf(s))&&(s=!1),r!==`
`&&r!=="\r"&&r!==`\r
`&&(r=`
`);var o=0,q=!1;this.parse=function(l,g,a){if(typeof l!="string")throw new Error("Input must be a string");var F=l.length,A=t.length,z=r.length,$=s.length,_=E(i),v=[],S=[],u=[],O=o=0;if(!l)return P();if(I||I!==!1&&l.indexOf(p)===-1){for(var j=l.split(r),w=0;w<j.length;w++){if(u=j[w],o+=u.length,w!==j.length-1)o+=r.length;else if(a)return P();if(!s||u.substring(0,$)!==s){if(_){if(v=[],ne(u.split(t)),X(),q)return P()}else ne(u.split(t));if(d&&d<=w)return v=v.slice(0,d),P(!0)}}return P()}for(var b=l.indexOf(t,o),m=l.indexOf(r,o),J=new RegExp(Y(x)+Y(p),"g"),f=l.indexOf(p,o);;)if(l[o]===p)for(f=o,o++;;){if((f=l.indexOf(p,f+1))===-1)return a||S.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:v.length,index:o}),G();if(f===F-1)return G(l.substring(o,f).replace(J,p));if(p===x&&l[f+1]===x)f++;else if(p===x||f===0||l[f-1]!==x){b!==-1&&b<f+1&&(b=l.indexOf(t,f+1));var R=ae((m=m!==-1&&m<f+1?l.indexOf(r,f+1):m)===-1?b:Math.min(b,m));if(l.substr(f+1+R,A)===t){u.push(l.substring(o,f).replace(J,p)),l[o=f+1+R+A]!==p&&(f=l.indexOf(p,o)),b=l.indexOf(t,o),m=l.indexOf(r,o);break}if(R=ae(m),l.substring(f+1+R,f+1+R+z)===r){if(u.push(l.substring(o,f).replace(J,p)),le(f+1+R+z),b=l.indexOf(t,o),f=l.indexOf(p,o),_&&(X(),q))return P();if(d&&v.length>=d)return P(!0);break}S.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:v.length,index:o}),f++}}else if(s&&u.length===0&&l.substring(o,o+$)===s){if(m===-1)return P();o=m+z,m=l.indexOf(r,o),b=l.indexOf(t,o)}else if(b!==-1&&(b<m||m===-1))u.push(l.substring(o,b)),o=b+A,b=l.indexOf(t,o);else{if(m===-1)break;if(u.push(l.substring(o,m)),le(m+z),_&&(X(),q))return P();if(d&&v.length>=d)return P(!0)}return G();function ne(M){v.push(M),O=o}function ae(M){var N=0;return N=M!==-1&&(M=l.substring(f+1,M))&&M.trim()===""?M.length:N}function G(M){return a||(M===void 0&&(M=l.substring(o)),u.push(M),o=F,ne(u),_&&X()),P()}function le(M){o=M,ne(u),u=[],m=l.indexOf(r,o)}function P(M){if(e.header&&!g&&v.length&&!V){var N=v[0],ee={},_e=new Set(N);let ye=!1;for(let oe=0;oe<N.length;oe++){let Z=N[oe];if(ee[Z=E(e.transformHeader)?e.transformHeader(Z,oe):Z]){let fe,we=ee[Z];for(;fe=Z+"_"+we,we++,_e.has(fe););_e.add(fe),N[oe]=fe,ee[Z]++,ye=!0,(K=K===null?{}:K)[fe]=Z}else ee[Z]=1,N[oe]=Z;_e.add(Z)}ye&&console.warn("Duplicate headers found and renamed."),V=!0}return{data:v,errors:S,meta:{delimiter:t,linebreak:r,aborted:q,truncated:!!M,cursor:O+(g||0),renamedHeaders:K}}}function X(){i(P()),v=[],S=[]}},this.abort=function(){q=!0},this.getCharIndex=function(){return o}}function he(e){var t=e.data,r=Q[t.workerId],s=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){s=!0,te(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:ve,resume:ve};if(E(r.userStep)){for(var d=0;d<t.results.data.length&&(r.userStep({data:t.results.data[d],errors:t.results.errors,meta:t.results.meta},i),!s);d++);delete t.results}else E(r.userChunk)&&(r.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!s&&te(t.workerId,t.results)}function te(e,t){var r=Q[e];E(r.userComplete)&&r.userComplete(t),r.terminate(),delete Q[e]}function ve(){throw new Error("Not implemented.")}function ge(e){if(typeof e!="object"||e===null)return e;var t,r=Array.isArray(e)?[]:{};for(t in e)r[t]=ge(e[t]);return r}function re(e,t){return function(){e.apply(t,arguments)}}function E(e){return typeof e=="function"}return n.parse=function(e,t){var r=(t=t||{}).dynamicTyping||!1;if(E(r)&&(t.dynamicTypingFunction=r,r={}),t.dynamicTyping=r,t.transform=!!E(t.transform)&&t.transform,!t.worker||!n.WORKERS_SUPPORTED)return r=null,n.NODE_STREAM_INPUT,typeof e=="string"?(e=(s=>s.charCodeAt(0)!==65279?s:s.slice(1))(e),r=new(t.download?H:D)(t)):e.readable===!0&&E(e.read)&&E(e.on)?r=new ie(t):(h.File&&e instanceof File||e instanceof Object)&&(r=new y(t)),r.stream(e);(r=(()=>{var s;return!!n.WORKERS_SUPPORTED&&(s=(()=>{var i=h.URL||h.webkitURL||null,d=L.toString();return n.BLOB_URL||(n.BLOB_URL=i.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",d,")();"],{type:"text/javascript"})))})(),(s=new h.Worker(s)).onmessage=he,s.id=W++,Q[s.id]=s)})()).userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=E(t.step),t.chunk=E(t.chunk),t.complete=E(t.complete),t.error=E(t.error),delete t.worker,r.postMessage({input:e,config:t,workerId:r.id})},n.unparse=function(e,t){var r=!1,s=!0,i=",",d=`\r
`,I='"',K=I+I,V=!1,p=null,x=!1,o=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||n.BAD_DELIMITERS.filter(function(g){return t.delimiter.indexOf(g)!==-1}).length||(i=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(r=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(V=t.skipEmptyLines),typeof t.newline=="string"&&(d=t.newline),typeof t.quoteChar=="string"&&(I=t.quoteChar),typeof t.header=="boolean"&&(s=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");p=t.columns}t.escapeChar!==void 0&&(K=t.escapeChar+I),t.escapeFormulae instanceof RegExp?x=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(x=/^[=+\-@\t\r].*$/)}})(),new RegExp(Y(I),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return q(null,e,V);if(typeof e[0]=="object")return q(p||Object.keys(e[0]),e,V)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||p),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),q(e.fields||[],e.data||[],V);throw new Error("Unable to serialize unrecognized input");function q(g,a,F){var A="",z=(typeof g=="string"&&(g=JSON.parse(g)),typeof a=="string"&&(a=JSON.parse(a)),Array.isArray(g)&&0<g.length),$=!Array.isArray(a[0]);if(z&&s){for(var _=0;_<g.length;_++)0<_&&(A+=i),A+=l(g[_],_);0<a.length&&(A+=d)}for(var v=0;v<a.length;v++){var S=(z?g:a[v]).length,u=!1,O=z?Object.keys(a[v]).length===0:a[v].length===0;if(F&&!z&&(u=F==="greedy"?a[v].join("").trim()==="":a[v].length===1&&a[v][0].length===0),F==="greedy"&&z){for(var j=[],w=0;w<S;w++){var b=$?g[w]:w;j.push(a[v][b])}u=j.join("").trim()===""}if(!u){for(var m=0;m<S;m++){0<m&&!O&&(A+=i);var J=z&&$?g[m]:m;A+=l(a[v][J],m)}v<a.length-1&&(!F||0<S&&!O)&&(A+=d)}}return A}function l(g,a){var F,A;return g==null?"":g.constructor===Date?JSON.stringify(g).slice(1,25):(A=!1,x&&typeof g=="string"&&x.test(g)&&(g="'"+g,A=!0),F=g.toString().replace(o,K),(A=A||r===!0||typeof r=="function"&&r(g,a)||Array.isArray(r)&&r[a]||((z,$)=>{for(var _=0;_<$.length;_++)if(-1<z.indexOf($[_]))return!0;return!1})(F,n.BAD_DELIMITERS)||-1<F.indexOf(i)||F.charAt(0)===" "||F.charAt(F.length-1)===" ")?I+F+I:F)}},n.RECORD_SEP="",n.UNIT_SEP="",n.BYTE_ORDER_MARK="\uFEFF",n.BAD_DELIMITERS=["\r",`
`,'"',n.BYTE_ORDER_MARK],n.WORKERS_SUPPORTED=!C&&!!h.Worker,n.NODE_STREAM_INPUT=1,n.LocalChunkSize=10485760,n.RemoteChunkSize=5242880,n.DefaultDelimiter=",",n.Parser=se,n.ParserHandle=ue,n.NetworkStreamer=H,n.FileStreamer=y,n.StringStreamer=D,n.ReadableStreamStreamer=ie,h.jQuery&&((U=h.jQuery).fn.parse=function(e){var t=e.config||{},r=[];return this.each(function(d){if(!(U(this).prop("tagName").toUpperCase()==="INPUT"&&U(this).attr("type").toLowerCase()==="file"&&h.FileReader)||!this.files||this.files.length===0)return!0;for(var I=0;I<this.files.length;I++)r.push({file:this.files[I],inputElem:this,instanceConfig:U.extend({},t)})}),s(),this;function s(){if(r.length===0)E(e.complete)&&e.complete();else{var d,I,K,V,p=r[0];if(E(e.before)){var x=e.before(p.file,p.inputElem);if(typeof x=="object"){if(x.action==="abort")return d="AbortError",I=p.file,K=p.inputElem,V=x.reason,void(E(e.error)&&e.error({name:d},I,K,V));if(x.action==="skip")return void i();typeof x.config=="object"&&(p.instanceConfig=U.extend(p.instanceConfig,x.config))}else if(x==="skip")return void i()}var o=p.instanceConfig.complete;p.instanceConfig.complete=function(q){E(o)&&o(q,p.file,p.inputElem),i()},n.parse(p.file,p.instanceConfig)}}function i(){r.splice(0,1),s()}}),k&&(h.onmessage=function(e){e=e.data,n.WORKER_ID===void 0&&e&&(n.WORKER_ID=e.workerId),typeof e.input=="string"?h.postMessage({workerId:n.WORKER_ID,results:n.parse(e.input,e.config),finished:!0}):(h.File&&e.input instanceof File||e.input instanceof Object)&&(e=n.parse(e.input,e.config))&&h.postMessage({workerId:n.WORKER_ID,results:e,finished:!0})}),(H.prototype=Object.create(c.prototype)).constructor=H,(y.prototype=Object.create(c.prototype)).constructor=y,(D.prototype=Object.create(D.prototype)).constructor=D,(ie.prototype=Object.create(c.prototype)).constructor=ie,n})}(de)),de.exports}var Le=Te();const Re=Se(Le);var pe={exports:{}},De=pe.exports,be;function Ie(){return be||(be=1,function(T,B){(function(L,h){h()})(De,function(){function L(n,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}function h(n,c,H){var y=new XMLHttpRequest;y.open("GET",n),y.responseType="blob",y.onload=function(){W(y.response,c,H)},y.onerror=function(){console.error("could not download file")},y.send()}function U(n){var c=new XMLHttpRequest;c.open("HEAD",n,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function C(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(c)}}var k=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ce=="object"&&ce.global===ce?ce:void 0,Q=k.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),W=k.saveAs||(typeof window!="object"||window!==k?function(){}:"download"in HTMLAnchorElement.prototype&&!Q?function(n,c,H){var y=k.URL||k.webkitURL,D=document.createElement("a");c=c||n.name||"download",D.download=c,D.rel="noopener",typeof n=="string"?(D.href=n,D.origin===location.origin?C(D):U(D.href)?h(n,c,H):C(D,D.target="_blank")):(D.href=y.createObjectURL(n),setTimeout(function(){y.revokeObjectURL(D.href)},4e4),setTimeout(function(){C(D)},0))}:"msSaveOrOpenBlob"in navigator?function(n,c,H){if(c=c||n.name||"download",typeof n!="string")navigator.msSaveOrOpenBlob(L(n,H),c);else if(U(n))h(n,c,H);else{var y=document.createElement("a");y.href=n,y.target="_blank",setTimeout(function(){C(y)})}}:function(n,c,H,y){if(y=y||open("","_blank"),y&&(y.document.title=y.document.body.innerText="downloading..."),typeof n=="string")return h(n,c,H);var D=n.type==="application/octet-stream",ie=/constructor/i.test(k.HTMLElement)||k.safari,ue=/CriOS\/[\d]+/.test(navigator.userAgent);if((ue||D&&ie||Q)&&typeof FileReader<"u"){var Y=new FileReader;Y.onloadend=function(){var te=Y.result;te=ue?te:te.replace(/^data:[^;]*;/,"data:attachment/file;"),y?y.location.href=te:location=te,y=null},Y.readAsDataURL(n)}else{var se=k.URL||k.webkitURL,he=se.createObjectURL(n);y?y.location=he:location.href=he,y=null,setTimeout(function(){se.revokeObjectURL(he)},4e4)}});k.saveAs=W.saveAs=W,T.exports=W})}(pe)),pe.exports}var Fe=Ie();const je=(T,B="books")=>new Promise((L,h)=>{const U={header:!0,dynamicTyping:!0,skipEmptyLines:!0,transformHeader:C=>C.trim(),complete:C=>{try{const k=Me(C.data,B);L(k)}catch(k){h(k)}},error:C=>{h(new Error(`CSV parsing error: ${C.message}`))}};Re.parse(T,U)}),Me=(T,B)=>{if(!Array.isArray(T)||T.length===0)throw new Error("Invalid data format or empty CSV");const L={books:["title"],authors:["name"],publishers:["name"],categories:["name"],loans:["bookId","borrowerName"]},h=T[0],C=(L[B]||[]).filter(k=>!(k in h));if(C.length>0)throw new Error(`Missing required fields: ${C.join(", ")}`);return T.map(k=>{const Q={};return Object.keys(k).forEach(W=>{if(W==="__proto__"||W==="constructor"||W.startsWith("__"))return;const n=k[W];typeof n=="string"?Q[W]=n.trim().substring(0,5e3):Q[W]=n}),Q})},ze=(T,B="export.csv")=>{try{const L=Re.unparse(T,{quotes:!0,delimiter:",",header:!0}),h=new Blob([L],{type:"text/csv;charset=utf-8;"});return Fe.saveAs(h,B),!0}catch(L){throw console.error("Error exporting to CSV:",L),new Error(`Failed to export to CSV: ${L.message}`)}},Ue=(T,B,L)=>T.map(h=>{const U={...h};if(U.loanDate)try{U.loanDate=new Date(U.loanDate).toISOString()}catch{}return U}),Be={importFromCSV:je,exportToCSV:ze,convertCollectionFormat:Ue};export{Pe as D,He as R,Be as c};
//# sourceMappingURL=csvService-DgcN5-Mj.js.map
